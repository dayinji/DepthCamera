!function(){"use strict";function t(){this.layers=document.getElementsByClassName("layer"),this.cameraMoveFunction=null,this.startTime=Date.now(),this.startPos=[0,0],this.currentPos=[0,0],this.targetPos=[0,0],this.duration=-1,this.callback=new Array}function s(t,s,e){t.style["webkit"+s]=e,t.style["moz"+s]=e,t.style["ms"+s]=e,t.style["o"+s]=e,t.style[s]=e}t.prototype.update=function(){var t,s=Date.now();if(this.isRunning()){if(null!=this.cameraMoveFunction)var t=this.cameraMoveFunction(s-this.startTime);else{var i,a=(s-this.startTime)/parseFloat(this.duration);switch(this.type){case this.MoveType.LINEAR:i=e.linear(a);break;case this.MoveType.EASE:i=e.ease(a);break;case this.MoveType.ELASTIC:i=e.elastic(a);break;case this.MoveType.SWING:i=e.swing(a);break;case this.MoveType.BOUNCE:i=e.bounce(a);break;default:i=e.ease(a)}var n=this.startPos[0]+(this.targetPos[0]-this.startPos[0])*i,r=this.startPos[1]+(this.targetPos[1]-this.startPos[1])*i;t=[n,r]}this.updatePos(t),requestAnimationFrame(this.update.bind(this))}else 0!=this.callback.length&&(this.reset(),this.callback.shift()())},t.prototype.updatePos=function(t){this.currentPos=t;for(var e=0;e<this.layers.length;e++){var i=this.layers[e];try{var a=parseFloat(i.attributes.depth.value)}catch(n){console.error(i),console.error("请给该标签添加[depth]属性")}s(i,"transform","translate3d("+t[0]/a+"px, "+t[1]/a+"px, "+100*-a+"px)")}},t.prototype.set=function(t){if(this.isRunning()){var s=this;return this.callback.push(function(){s.set(t)}),this}return this.targetPos=t,this.updatePos(t),this.reset(),0!=this.callback.length&&this.callback.shift()(),this},t.prototype.moveTo=function(t,s,e,i){if(arguments[1]=arguments[1]?arguments[1]:1e3,arguments[2]=arguments[2]?arguments[2]:this.MoveType.EASE,arguments[3]=arguments[3]?arguments[3]:null,this.isRunning()){var a=this;return this.callback.push(function(){a.moveTo(t,s,e,i)}),this}return this.targetPos=t,this.startTime=Date.now(),this.duration=s,this.type=e,null!=i&&this.callback.push(i),this.update(),this},t.prototype.exec=function(t,s,e){if(arguments[1]=arguments[1]?arguments[1]:1e3,arguments[2]=arguments[2]?arguments[2]:null,this.isRunning()){var i=this;return this.callback.push(function(){i.exec(t,s,e)}),this}return this.cameraMoveFunction=t,this.duration=s==this.INFINITE?9999999999999:s,this.startTime=Date.now(),null!=e&&this.callback.push(e),this.update(),this},t.prototype.pause=function(t,s){if(arguments[0]=arguments[0]?arguments[0]:1e3,arguments[1]=arguments[1]?arguments[1]:null,this.isRunning()){var e=this;return this.callback.push(function(){e.pause(t,s)}),this}return this.startTime=Date.now(),this.duration=t,null!=s&&this.callback.push(s),this.update(),this},t.prototype.stop=function(){return this.reset(),0!=this.callback.length&&this.callback.splice(0,this.callback.length),this},t.prototype.MoveType={LINEAR:0,EASE:1,ELASTIC:2,SWING:3,BOUNCE:4},t.prototype.reset=function(){this.cameraMoveFunction=null,this.startTime=Date.now(),this.startPos=this.currentPos,this.targetPos=this.currentPos,this.duration=-1,this.type=this.MoveType.LINEAR},t.prototype.isRunning=function(){return this.duration>=Date.now()-this.startTime},t.prototype.INFINITE=-2;var e={linear:function(t){return t},ease:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swing:function(t){var s=1.70158;return(t-=1)*t*((s+1)*t+s)+1},bounce:function(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}};window.DepthCamera=t}();